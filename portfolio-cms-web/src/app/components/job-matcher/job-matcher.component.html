<div class="job-matcher-container">
  <div class="page-header">
    <h1 class="page-title">üéØ {{ 'nav.jobMatcher' | translate }}</h1>
  </div>

  <div class="matcher-layout">
    <!-- Left: Input panel -->
    <div class="input-panel">
      <div class="panel-card">
        <h3 class="panel-title">Paste Job Description</h3>
        <p class="panel-desc">Paste the full job description to analyze how well your CV matches.</p>
        <textarea
          class="form-textarea"
          [(ngModel)]="jobDescription"
          placeholder="Paste the job description here..."
          rows="12"
        ></textarea>
        <div class="panel-actions">
          <button class="btn-analyze" (click)="analyzeJob()" [disabled]="analyzing || !jobDescription.trim()">
            <span *ngIf="!analyzing">üîç Analyze Match</span>
            <span *ngIf="analyzing" class="spinner-inline">‚è≥ Analyzing...</span>
          </button>
          <button class="btn-clear" (click)="clearAnalysis()" *ngIf="analysis">Clear</button>
        </div>
      </div>

      <!-- Recent Matches -->
      <div class="panel-card">
        <h3 class="panel-title">Recent Matches</h3>
        <div class="recent-list">
          <div class="recent-item" *ngFor="let match of recentMatches">
            <div class="recent-info">
              <span class="recent-title">{{ match.title }}</span>
              <span class="recent-company">{{ match.company }}</span>
            </div>
            <div class="recent-score" [style.color]="getScoreColor(match.score)">{{ match.score }}%</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right: Results -->
    <div class="results-panel" *ngIf="analysis">
      <!-- Score Gauge -->
      <div class="panel-card score-card">
        <div class="score-header">
          <div>
            <h3 class="panel-title">{{ analysis.title }}</h3>
            <p class="panel-desc">{{ analysis.company }}</p>
          </div>
          <span class="score-badge" [style.background]="getScoreColor(analysis.matchScore)">
            {{ getScoreLabel(analysis.matchScore) }}
          </span>
        </div>
        <div class="gauge-container">
          <svg viewBox="0 0 120 120" class="gauge-svg">
            <circle cx="60" cy="60" r="52" fill="none" stroke="var(--border)" stroke-width="8" />
            <circle cx="60" cy="60" r="52" fill="none"
              [attr.stroke]="getScoreColor(analysis.matchScore)"
              stroke-width="8" stroke-linecap="round"
              [attr.stroke-dasharray]="matchDashArray"
              transform="rotate(-90 60 60)" />
          </svg>
          <div class="gauge-center">
            <span class="gauge-value">{{ analysis.matchScore }}%</span>
            <span class="gauge-label">Match</span>
          </div>
        </div>
      </div>

      <!-- Skill Breakdown -->
      <div class="panel-card">
        <h3 class="panel-title">Skill Analysis</h3>
        <div class="skill-groups">
          <div class="skill-group" *ngIf="strongSkills.length">
            <h4 class="group-label strong">‚úÖ Strong Match ({{ strongSkills.length }})</h4>
            <div class="skill-chips">
              <span class="chip chip-strong" *ngFor="let s of strongSkills">{{ s.skill }}</span>
            </div>
          </div>
          <div class="skill-group" *ngIf="partialSkills.length">
            <h4 class="group-label partial">‚ö° Partial Match ({{ partialSkills.length }})</h4>
            <div class="skill-chips">
              <span class="chip chip-partial" *ngFor="let s of partialSkills">{{ s.skill }}</span>
            </div>
          </div>
          <div class="skill-group" *ngIf="missingSkills.length">
            <h4 class="group-label missing">‚ùå Missing ({{ missingSkills.length }})</h4>
            <div class="skill-chips">
              <span class="chip chip-missing" *ngFor="let s of missingSkills">{{ s.skill }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Keywords -->
      <div class="panel-card">
        <h3 class="panel-title">Key Requirements</h3>
        <div class="keyword-tags">
          <span class="keyword-tag" *ngFor="let kw of analysis.keywords">{{ kw }}</span>
        </div>
      </div>

      <!-- Suggestions -->
      <div class="panel-card">
        <h3 class="panel-title">üí° Improvement Suggestions</h3>
        <div class="suggestions-list">
          <div class="suggestion-item" *ngFor="let suggestion of analysis.suggestions; let i = index">
            <span class="suggestion-num">{{ i + 1 }}</span>
            <span class="suggestion-text">{{ suggestion }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div class="results-panel empty-state" *ngIf="!analysis && !analyzing">
      <div class="empty-inner">
        <span class="empty-icon">üéØ</span>
        <h3>Paste a Job Description</h3>
        <p>Paste the job posting and click Analyze to see how your CV matches the requirements.</p>
      </div>
    </div>

    <!-- Loading State -->
    <div class="results-panel loading-state" *ngIf="analyzing">
      <div class="empty-inner">
        <div class="loading-spinner"></div>
        <h3>Analyzing Job Description...</h3>
        <p>Comparing your CV against the job requirements.</p>
      </div>
    </div>
  </div>
</div>
